import{c as h}from"./editor.0b27adde.js";import{h as D,o as i,c as o,b as c,P as u,z as f,A as p,q as b,j as g}from"./index.d2b5948f.js";import{_}from"./App.8a7f3b43.js";import"https://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenLite.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TimelineLite.min.js";const C={props:["container"],data(){return{selected:null,mappedData:[],canvasContainer:D}},methods:{getData(){return this.container.sheetData?this.container.sheetData:this.canvasContainer.sheetData},upsert(t,e){const a=t.findIndex(r=>r.elName===e.elName);a>-1?t[a]=e:t.push(e)},setMappedData:function(t,e){if(this.upsert(this.container.mappedData,{elName:e,dataID:t.target.value}),this.selected.attrs.type){var a=this.selected.attrs.type,r=this.container.sheetData[0][t.target.value];a==="text"&&h.changeText(this.selected,r),a==="barcodeBasic"&&h.changeBarcodeBasic(this.selected,r),a==="barcode"&&h.changeBarcode(this.selected,r),a==="qrcode"&&h.changeQrCode(this.selected,r),a==="image"&&h.changeImage(this.selected,r)}},isSelected:function(t,e){let a=!1;return this.container.mappedData.forEach(r=>{r.dataID==e&&r.elName==t&&(a=!0)}),a},getMappedData:function(){},mapData:function(t,e,a){let r={el:a,dataId:e};return this.mappedData.push(r),t},showData:function(t){var e=XLSX.utils.sheet_to_json(t,{header:1});return e[0]},filterList:function(t){return t.filter(e=>e.getClassName()!=="Transformer"&&e.getClassName()!=="Rect"&&e.getClassName()!=="Line"&&e.getClassName()!=="RegularPolygon"&&e.getClassName()!=="RegularPolygon"&&e.getClassName()!=="Circle"&&e.getClassName()!=="Star"&&e.getClassName()!=="Arc"&&e.getClassName()!=="Ellipse")},selectElementOnEditor:function(t){this.container.editor.mark(t),this.container.editor.transform.nodes([]),this.selected=t,this.container.editor.selected=t,this.container.editor.selectEvent.data=t,document.dispatchEvent(this.container.editor.selectEvent)},isElementSelected:function(t){return this.container.editor.selected?!!this.container.editor.transform.nodes().includes(t):!1},clearMappedData(){this.container.mappedData.length=0}},mounted(){this.container.sheetData||(this.container.sheetData=this.canvasContainer.sheetData)}},k={class:"flex flex-col gap-5 relative"},y={key:0,class:"flex flex-col gap-5 border rounded px-2 py-2 shadow-lg"},v={class:"font-bold"},N=["onClick"],x={class:"py-1"},E=["onChange"],M=c("option",{value:"none"},"None",-1),w=["selected","value"];function B(t,e,a,r,S,s){return i(),o("div",k,[a.container.editor.layer.children?(i(),o("div",y,[c("div",{onClick:e[1]||(e[1]=(...n)=>s.getMappedData&&s.getMappedData(...n)),class:"text-center"},[c("div",v,u(t.$t("sidebar.dataMapping.text")),1),c("button",{onClick:e[0]||(e[0]=(...n)=>s.clearMappedData&&s.clearMappedData(...n))},u(t.$t("sidebar.mapping.clearMappedData")),1)]),(i(!0),o(f,null,p(s.filterList(a.container.editor.layer.children),(n,m)=>(i(),o("div",{class:b(["w-full border-gray-400 rounded shadow-md px-2 py-2 cursor-pointer hover:border-blue-400",{"bg-gray-400 text-white":s.isElementSelected(n)}]),onClick:d=>s.selectElementOnEditor(n),key:m},[c("div",null,[c("h2",x,u(n.name()),1)]),a.container.sheetData?(i(),o("select",{key:0,onChange:d=>s.setMappedData(d,n.name()),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[M,(i(!0),o(f,null,p(a.container.sheetData[0],(d,l)=>(i(),o(f,{key:l},[typeof d!="object"?(i(),o("option",{key:0,selected:s.isSelected(n.name(),l),value:l},u(typeof l=="number"?"":l.replace("_"," ").replace("_"," ")+": ")+" "+u(d),9,w)):g("",!0)],64))),128))],40,E)):g("",!0)],10,N))),128))])):g("",!0)])}const q=_(C,[["render",B]]);export{q as default};
